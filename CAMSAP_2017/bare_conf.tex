
%% bare_conf.tex
%% V1.3
%% 2007/01/11
%% by Michael Shell
%% See:
%% http://www.michaelshell.org/
%% for current contact information.
%%
%% This is a skeleton file demonstrating the use of IEEEtran.cls
%% (requires IEEEtran.cls version 1.7 or later) with an IEEE conference paper.
%%
%% Support sites:
%% http://www.michaelshell.org/tex/ieeetran/
%% http://www.ctan.org/tex-archive/macros/latex/contrib/IEEEtran/
%% and
%% http://www.ieee.org/

%%*************************************************************************
%% Legal Notice:
%% This code is offered as-is without any warranty either expressed or
%% implied; without even the implied warranty of MERCHANTABILITY or
%% FITNESS FOR A PARTICULAR PURPOSE! 
%% User assumes all risk.
%% In no event shall IEEE or any contributor to this code be liable for
%% any damages or losses, including, but not limited to, incidental,
%% consequential, or any other damages, resulting from the use or misuse
%% of any information contained here.
%%
%% All comments are the opinions of their respective authors and are not
%% necessarily endorsed by the IEEE.
%%
%% This work is distributed under the LaTeX Project Public License (LPPL)
%% ( http://www.latex-project.org/ ) version 1.3, and may be freely used,
%% distributed and modified. A copy of the LPPL, version 1.3, is included
%% in the base LaTeX documentation of all distributions of LaTeX released
%% 2003/12/01 or later.
%% Retain all contribution notices and credits.
%% ** Modified files should be clearly indicated as such, including  **
%% ** renaming them and changing author support contact information. **
%%
%% File list of work: IEEEtran.cls, IEEEtran_HOWTO.pdf, bare_adv.tex,
%%                    bare_conf.tex, bare_jrnl.tex, bare_jrnl_compsoc.tex
%%*************************************************************************

% *** Authors should verify (and, if needed, correct) their LaTeX system  ***
% *** with the testflow diagnostic prior to trusting their LaTeX platform ***
% *** with production work. IEEE's font choices can trigger bugs that do  ***
% *** not appear when using other class files.                            ***
% The testflow support page is at:
% http://www.michaelshell.org/tex/testflow/



% Note that the a4paper option is mainly intended so that authors in
% countries using A4 can easily print to A4 and see how their papers will
% look in print - the typesetting of the document will not typically be
% affected with changes in paper size (but the bottom and side margins will).
% Use the testflow package mentioned above to verify correct handling of
% both paper sizes by the user's LaTeX system.
%
% Also note that the "draftcls" or "draftclsnofoot", not "draft", option
% should be used if it is desired that the figures are to be displayed in
% draft mode.
%
\documentclass[conference]{IEEEtran}
% Add the compsoc option for Computer Society conferences.
%
% If IEEEtran.cls has not been installed into the LaTeX system files,
% manually specify the path to it like:
% \documentclass[conference]{../sty/IEEEtran}


\input{latex-aux/packages}

\input{latex-aux/mymath}

\input{latex-aux/acronyms.tex}

\input{latex-aux/symbols.tex}

\begin{document}
%
% paper title
% can use linebreaks \\ within to get better formatting as desired
\title{Tensor-Based Compressed Estimation of Frequency-Selective mmWave MIMO Channels}


% author names and affiliations
% use a multiple column layout for up to three different
% affiliations
\author{\IEEEauthorblockN{Daniel C. Ara\'ujo}
\IEEEauthorblockA{Research Group of Wireless Communication (GTEL) \\Department of Teleinformatics\\
Federal University of Cear\'a\\
Cear\'a, Fortaleza 60020-181\\
Email: araujo@gtel.ufc.br}
\and
\IEEEauthorblockN{Andr\'e Lima F. de Almeida}
\IEEEauthorblockA{Research Group of Wireless Communication (GTEL) \\Department of Teleinformatics\\
Federal University of Cear\'a\\
Cear\'a, Fortaleza 60020-181\\
Email: andre@gtel.ufc.br}}

% conference papers do not typically use \thanks and this command
% is locked out in conference mode. If really needed, such as for
% the acknowledgment of grants, issue a \IEEEoverridecommandlockouts
% after \documentclass

% for over three affiliations, or if they all won't fit within the width
% of the page, use this alternative format:
% 
%\author{\IEEEauthorblockN{Michael Shell\IEEEauthorrefmark{1},
%Homer Simpson\IEEEauthorrefmark{2},
%James Kirk\IEEEauthorrefmark{3}, 
%Montgomery Scott\IEEEauthorrefmark{3} and
%Eldon Tyrell\IEEEauthorrefmark{4}}
%\IEEEauthorblockA{\IEEEauthorrefmark{1}School of Electrical and Computer Engineering\\
%Georgia Institute of Technology,
%Atlanta, Georgia 30332--0250\\ Email: see http://www.michaelshell.org/contact.html}
%\IEEEauthorblockA{\IEEEauthorrefmark{2}Twentieth Century Fox, Springfield, USA\\
%Email: homer@thesimpsons.com}
%\IEEEauthorblockA{\IEEEauthorrefmark{3}Starfleet Academy, San Francisco, California 96678-2391\\
%Telephone: (800) 555--1212, Fax: (888) 555--1212}
%\IEEEauthorblockA{\IEEEauthorrefmark{4}Tyrell Inc., 123 Replicant Street, Los Angeles, California 90210--4321}}



% use for special paper notices
%\IEEEspecialpapernotice{(Invited Paper)}




% make the title area
\maketitle

\begin{abstract}
%\boldmath
This paper develops a novel hybrid analog-digital frequency selective channel estimation technique
assuming multiple antennas at the transmitter and multiple antennas at the
receiver. We link the estimation problem to the \gls{PARAFAC} analysis by
modeling the effective frequency-selective MIMO as a third order tensor. We leverage on this link to derive
a solution that jointly estimates the transmit-receive spatial characteristics and
the delay pattern of the multidimensional channel. The proposed method relies on the joint
sparsity of the spatial and delay domains, thereby affording the system to use
short  pilot sequences and very few beams to accurate estimate channel. Moreover, we exploit the
fundamental results of Kruskal's uniqueness for tensor compressive sensing
\cite{Sidiropoulos:2012} to derive useful bounds on the minimum number of beams
and pilot sequence length. The simulation results show that the proposed
solution can achieve very accurate estimates if the system meets Kruskal conditions. 
\end{abstract}
% IEEEtran.cls defaults to using nonbold math in the Abstract.
% This preserves the distinction between vectors and scalars. However,
% if the conference you are submitting to favors bold math in the abstract,
% then you can use LaTeX's standard command \boldmath at the very start
% of the abstract to achieve this. Many IEEE journals/conferences frown on
% math in the abstract anyway.

% no keywords




% For peer review papers, you can put extra information on the cover
% page as needed:
% \ifCLASSOPTIONpeerreview
% \begin{center} \bfseries EDICS Category: 3-BBND \end{center}
% \fi
%
% For peerreview papers, this IEEEtran command inserts a page break and
% creates the second title. It will be ignored for other modes.
\IEEEpeerreviewmaketitle



\section{Introduction}

Beamforming for 5G mobile communication systems promises to enable a great
increase in wireless data rate due to the massive number of antennas intended to
be implemented at the \gls{BS}. Massive \gls{mimo} has the potential to provide
extremely high energy and spectrum efficiency required by the 5G
networks\cite{Larsson:2014}.
Such a potential is achieved if the system
\begin{inparaenum}[(i)]
\item implements digital beamforming and
\item has \gls{csi} available \cite{Gao:2016a}.
\end{inparaenum}

The implementation of a complete digital architecture for massive \gls{mimo}
systems is a tremendous challenge \cite{Alkhateeb:2014}. For each antenna element, it has associated a
dedicated \gls{RF} chain, which includes power amplifier (low-noise amplifier at the
receiver), \gls{DAC} (\gls{ADC} at the receiver) and so on
\cite{Venkateswaran:2008,Alkhateeb:2014}; therefore, when the number of antennas
increases the power consumption from high resolution \gls{ADC} and \gls{DAC}
becomes prohibitive \cite{Alkhateeb:2014,Alkhateeb:2016a}. The use of \gls{HB}
to deploy massive \gls{mimo} has called attention, for its architecture can be
implemented with limited number of \gls{RF} chains, i.e. the number of \gls{DAC}
(\gls{ADC} at the receiver) is reduced. Essentially, the hybrid architecture has
a digital part which performs the baseband processing using microprocessors
whereas, the analog part is implemented at the \gls{RF} frequency by using a
phase-shifter network \cite{Heath:2016,Alkhateeb:2014,Alkhateeb:2016a}.

To design the \gls{HB} and provide the expected massive \gls{mimo} gains, the
transceiver must have partial or complete \gls{csi} knowledge. The channel
acquisition phase is crucial due to the large system overhead which grows proportionally
to the number of antennas. Therefore, the development of a \gls{csi} estimator
that fits to a hybrid massive \gls{mimo} transceiver must take into account the
digital-analog architecture and provide reliable estimates with short pilot
sequences \cite{Alkhateeb:2014,Alkhateeb:2016a}. The use of large bandwidth in
the next generation of wireless systems poses an additional challenge to problem, since the channel is frequency selective.
%which is the
% frequency selective channel. The current paper particularly comprises all the three aspects
% \begin{inparaenum}[(i)]
% \item \gls{HB} architecture,
% \item pilot overhead, and
% \item frequency selective channel
% \end{inparaenum}
% and aims at proposing a novel \gls{csi} estimator.

% Although there are some works to which the \gls{HB} and channel estimation are considered such as
% \cite{Heath:2016,Alkhateeb:2014}, they do not cover the frequency selectivity
% case.

The works \cite{Heath:2016,Alkhateeb:2014} discuss the problem of channel
estimation for \gls{HB} architectures, and solutions based on \gls{cs} are
proposed. Recently, \cite{Venugopal:2017} presents a solution that deals
with frequency selective channels. The idea consists of stacking the received signal of
multiple frames each one associated to a given transmit beam. Using the \gls{cs}
framework, the receiver is capable of extracting the \gls{AoD} and the path gain
associated to each path. Although this technique provides very accurate
estimates as shown in \cite{Venugopal:2017},  the extension for 
multiple antennas at the receiver becomes prohibitive since the dimension of the
stacked received signal vector is very large which leads to high computational
complexity of the sparse recovery algorithm.

The proposed solution consists of modeling the frequency selective channel as a
third-order tensor \cite{Kolda:2009,Sidiropoulos:2000}. Such mathematical
formalism is the natural extension of vector and matrices for multidimensional
spaces and enables us to exploit well established models that carrier
with them conditions to guarantee uniqueness in tensor problems. We explore
herein a novel approach for estimating the massive \gls{mimo} frequency
selective channels that relies on the tensor compressive sensing problem, originally presented in \cite{Sidiropoulos:2012}. More specifically, this paper establishes a link between the fundamental Kruskal's uniqueness results for compressive \gls{PARAFAC} analysis to the compressive estimation of frequency-selective mmWave \gls{mimo} channels.% These uniqueness results 



%the sparse \gls{PARAFAC} analysis. Our work
% link the sparse channel estimation problem to sparse \gls{PARAFAC} proposed in
% \cite{Sidiropoulos:2012}. Such a model relies on the fundamental result of
% Kruskal \cite{Sidiropoulos:2000} and its further extension to sparse tensor in
% \cite{Sidiropoulos:2012}. Using the Kruskal conditions for sparse \gls{PARAFAC}
% model, we guarantee its uniqueness and retrieve the factor matrices
% \cite{Kolda:2009} that
% describes the compressed space and time domains within a given transmission
% frame. Then, such matrices are the input for three \gls{cs} problems that
% extract  the sparse decomposition of the factor matrices.


\textit{Notation}: A scalar is denoted in italic, e.g. $a$. A column vector is a
bold lowercase letter, e.g. $\bfa$ whose $i$th entry is $\bfa(i)$. A matrix is
denoted by a bold uppercase letter, e.g. $\bfA$ with $(i,j)$th entry
$\bfA(i,j)$; $\bfA(:,j)$ is the $j$th column of $\bfA$. A third-order tensor is
a caligrafic uppercase letter, e.g. $\calA$ with $(i,j,k)$th entry
$\calA(i,j,k)$. The $\Vector{.}$ operator stacks the columns of its argument
into one big column  vector; $\otimes$ stands for the Kronecker product,
$\odot$ is the Khatri-Rao product (column-wise Kronecker product)
$\times _i $ is the mode product over the $i$th tensor dimension  \cite{Sidiropoulos:2000,Kolda:2009}.
\section{System Model}

Consider a single user \gls{mimo} system with transmitter and receiver equipped with
\gls{nAntTx} and  \gls{nAntRx} antennas, respectively. Assume that both transmitter and
receiver employ a hybrid beamforming structure using  \gls{nRFTx} and
\gls{nRFRx} \gls{RF} chains, respectively. The spatial filter at the transmitter
and receiver are $\gls{txBeamMtx}=\gls{txAnalogMtx}\gls{txDigitalMtx}$ $\in$
$\mathbb{C}^{\gls{nAntTx} \times \gls{nTxBeam}}$ and
$\gls{rxBeamMtx}=\gls{rxAnalogMtx}\gls{rxDigitalMtx}$ $\mathbb{C}^{\gls{nAntRx}
  \times \gls{nRxBeam}}$, where $\gls{nTxBeam} \leq
\gls{nRFTx}$ and $\gls{nRxBeam} \leq
\gls{nRFRx}$  denote the number of beams used in the same
communication resource at the transmitter and receiver, respectively. The transmitter uses multiple beams to send a single pilot sequence with length \gls{pLength}
into \gls{nTxBeam} directions, and the receiver uses the multiple \gls{RF}
chains to collect the incoming training signal from different directions. The
channel matrix is defined as a summation of  \gls{nTaps} delay tap matrices 
$\gls{chMtx}_{\gls{tapIdx}}$, $\gls{tapIdx}=\{0,1, \ldots, \gls{nTaps}-1\}$. The
variable $\rho$ denotes the average received power and
$\gls{noiseVec}_{\gls{timeIdx}} \sim $ $\mathcal{N}(0,\sigma ^2\gls{noiseCov})$
the circularly symmetric complex Gaussian distributed noise vector, therefore, the received signal is expressed as
% Consider a  $\gls{nAntRx} \times \gls{nAntTx}$  channel matrix between transmitter and receiver
% composed by a summation of  \gls{nTaps} delay tap matrices $\gls{chMtx}_{\gls{tapIdx}}$,
% $\gls{tapIdx}=\{0,1, \ldots, \gls{nTaps}-1\}$. The variable $\rho$ denotes the average received power and $\gls{noiseVec}_{\gls{timeIdx}} \sim $
% $\mathcal{N}(0,\sigma ^2\gls{noiseCov})$ the circularly symmetric complex Gaussian
% distributed noise vector, therefore, the received signal is expressed as
\begin{equation}
  \label{eq:rx_signal}
  \gls{rxVec}_{\gls{txBeamIdx},\gls{timeIdx}} = \sqrt{\rho} \sum_{\gls{tapIdx}=0}^{\gls{nTaps}-1} \gls{chMtx}_{\gls{tapIdx}} \gls{txBeamMtx}(:,{\gls{txBeamIdx}})s_{\gls{timeIdx}-\gls{tapIdx}} + \gls{noiseVec}_{\gls{txBeamIdx},\gls{timeIdx}},
\end{equation}
where \gls{txBeamIdx} is the beam index associated to transmit a given frame, $\gls{pSym}_{\gls{timeIdx}}$ is the \gls{timeIdx}th non-zero instance of the
training frame 
\begin{equation}
  \label{eq:frame}
  \gls{pSymVec} = [0, \ldots, 0,  \gls{pSym}_1, \gls{pSym}_2, \ldots, \gls{pSym}_{\gls{pLength}} ]
\end{equation}
of length $\gls{nTime}=\gls{pLength}+\gls{nTaps}-1$. Each transmit frame is associated to a
specific beam pattern, i.e. assuming a codebook with \gls{nTxBeam} beam
patterns, the system needs to \gls{nTxBeam} training frames to use beams
specified by the codebook. Each frame carriers a pilot sequence with
$\gls{pLength}$ symbols. Fig. \ref{fig:frame} shows the frame configuration of
the system.

\begin{figure}[t!]
  \centering
  \includegraphics[width=0.48\textwidth]{fig/frame}
  \caption{Each frame carries the same pilot sequence. The receiver uses the same set of
    beams while the transmitter changes the beam from frame-to-frame.}
  \label{fig:frame}
\end{figure}


The receiver applies the combiner $\gls{rxBeamMtx}(:,\gls{rxBeamIdx})$  over the
training frame, so that the combiner output is expressed as

\begin{equation}
  \label{eq:output_combiner}
   \gls{rxOutput}_{\gls{rxBeamIdx},\gls{txBeamIdx},\gls{timeIdx}} = \sqrt{\rho}\gls{rxBeamMtx}(:,{\gls{rxBeamIdx}})^T \sum_{d=0}^{N_c-1} \gls{chMtx}_{\gls{tapIdx}}\gls{txBeamMtx}(:,{\gls{txBeamIdx}})s_{\gls{timeIdx}-\gls{tapIdx}} + \gls{noise}_{\gls{rxBeamIdx},\gls{txBeamIdx},\gls{timeIdx}},
 \end{equation}
 where $\gls{noise}_{\gls{rxBeamIdx},\gls{txBeamIdx},\gls{timeIdx}} = \gls{rxBeamVec}^H_{\gls{rxBeamIdx}}\gls{noiseVec}_{\gls{txBeamIdx},\gls{timeIdx}}$
The output signal can be described in terms of tensor notation \cite{Kolda:2009,Sidiropoulos:2000}
\begin{equation}
  \label{eq:output_combiner_tensor}
  \gls{rxOutput}_{\gls{rxBeamIdx},\gls{txBeamIdx},\gls{timeIdx}} =  \gls{chTen} \times_1 \gls{rxBeamMtx}(:,{\gls{rxBeamIdx}})^T \times_2 \gls{txBeamMtx}(:,{\gls{txBeamIdx}})^T \times_3 \gls{pSymMtx}(:,\gls{timeIdx})^T,
\end{equation}
where $\gls{chTen}$ $\in$ $\mathbb{C}^{\gls{nAntRx} \times \gls{nAntTx} \times \gls{nTaps}}$ is generated from the concatenation in the third dimension
of the $\gls{nTaps}$ delay taps, and \gls{pSymMtx} $\in$
$\mathbb{C}^{\gls{nTaps} \times \gls{pLength}}$ is the convolution matrix
containing the pilot sequence
$$  \gls{pSymMtx}^T =
  \begin{bmatrix}
     \gls{pSym}_1 & 0 & \ldots & 0 \\
     \gls{pSym}_2 &  \gls{pSym}_1 & \ldots & 0 \\
    \vdots & \vdots & \ddots & \vdots \\
    \gls{pSym}_{\gls{pLength}} & \ldots & \ldots & \gls{pSym}_{\gls{nTime}}
  \end{bmatrix}.
 $$    

Assuming a collection  of transmitter and receiver beams, i.e.
$\gls{txBeamIdx}=\{1,\ldots , \gls{nTxBeam} \}$ and $\gls{rxBeamIdx}=\{1,\ldots , \gls{nRxBeam} \}$, respectively, and the $\gls{nTime}$ time
instants within the training frame, we can express the signal model as the
third-order tensor \cite{Sidiropoulos:2000,Cichocki:2009}
\begin{equation}
  \label{eq:tensor_model}
  \gls{rxOutputTen} =   \gls{chTen}\times_1  \gls{rxBeamMtx}^T \times_2  \gls{txBeamMtx}^T \times_3 \gls{pSymMtx}^T + \gls{noiseTen} \times_1 \gls{rxBeamMtx}^T  .
\end{equation}


There are two basic multiway models largely used in the literature: Tucker3 and
\gls{PARAFAC}. The first  is essential for data compression
as shown in \cite{Duarte:2012}, but its uniqueness cannot be
ensured in general. The second is identifiable  under mild conditions related with
the concept of the \textit{Kruskal-rank} \cite{Sidiropoulos:2000,Smilde:2004}. %In the next section, we establish  the
%link between the \gls{PARAFAC} model and the sparse channel estimation problem.


\section{Channel Estimation via Multiway Compressive Sensing}
\label{sec:multiway_cs}

In this section, we propose a channel estimator method that leverages on the
\gls{PARAFAC} uniqueness properties and the joint sparse of the transmitter-receiver
angular and delay domains. 


\subsection{Sparse \gls{PARAFAC} Formulation}
\label{sec:parafac_model}

Consider a geometric  channel model for a frequency selective channel
\begin{align}
  \label{eq:tap_model}
  \gls{chMtx} & = \sum_{\gls{tapIdx}=0}^{\gls{nTaps}-1}  \gls{chMtx}_{\gls{tapIdx}} \nonumber \\
              & = \sum_{\gls{tapIdx}=0}^{\gls{nTaps}-1}\gls{cplxGain}_{\gls{tapIdx}}\gls{pulse}(\gls{tapIdx}\gls{timeSamp} - \gls{delay}_{\gls{tapIdx}})\gls{rxStrVec}\gls{txStrVec}^H,
\end{align}
where $\gls{pulse}(\gls{delay})$
denotes the system pulse shaping evaluated at
$\gls{delay}$, $\gls{cplxGain}_{\gls{tapIdx}}$ $\in$ $\mathbb{C}$ is the complex
gain associated to the $\gls{tapIdx}$th path, $\gls{delay}_{\gls{tapIdx}}$ $\in$
$\mathbb{R}$ is the delay of the \gls{tapIdx}th path, \gls{azm} $\in$ $[0,2\pi)$
and \gls{elev} $\in$ $[0,2\pi)$ are the \gls{AoA} and \gls{AoD},
respectively, and \gls{rxStrVec} $\in$ $\mathbb{C}^{\gls{nAntRx}}$ and
\gls{txStrVec} $\in$ $\mathbb{C}^{\gls{nAntTx}}$ are the antenna response vector
of the transmitter and receiver, respectively. 

The channel model in \eqref{eq:tap_model} can be conveniently represented as a
third-order tensor by concatenating the  $\gls{chMtx}_{\gls{tapIdx}}$ to form a
cube. This results in a \gls{PARAFAC} model to which the core tensor is
the identity tensor \gls{eyeTen}, the factor matrices \gls{rxStrMtx} $\in$
$\mathbb{C}^{\gls{nAntRx} \times \gls{nTaps}}$  and \gls{txStrMtx} $\in$
$\mathbb{C}^{\gls{nAntTx} \times \gls{nTaps}}$ contain the steering vectors
\gls{rxStrVec} and \gls{txStrVec} $\forall$
$\gls{tapIdx}=\{0,\ldots,\gls{nTaps}-1\}$, and  $\gls{delayMtx} =
\textrm{diag}\{\gls{cplxGain}_0\gls{pulse}(\gls{timeIdx}\gls{timeSamp} - \gls{delay}_{0}),
\ldots , \gls{cplxGain}_{\gls{nTaps}-1}\gls{pulse}(\gls{timeIdx}\gls{timeSamp} -
\gls{delay}_{\gls{nTaps}-1})\}$. The spatio-delay channel response can be
written as 
\begin{equation}
  \label{eq:mode_product_parafac}
  \gls{chTen} = \gls{eyeTen} \times _1 \gls{rxStrMtx} \times_2  \gls{txStrMtx}^{*} \times_3 \gls{delayMtx}.
\end{equation}
Substituting \eqref{eq:mode_product_parafac} into  \eqref{eq:tensor_model}, the
received signal fits into a \gls{PARAFAC} model up to an error
accounted in $\gls{errorTen} = \gls{noiseTen} \times \gls{rxBeamMtx}^H$
\begin{equation}
  \label{eq:parafac_rx_signal}
    \gls{rxOutputTen}=   \gls{eyeTen} \times_1  \gls{rxBeamMtx}^T\gls{rxStrMtx} \times_2  \gls{txBeamMtx}^T\gls{txStrMtx}^{*} \times_3 \gls{pSymMtx}^T\gls{delayMtx} + \gls{errorTen}.
\end{equation}
Comparing \eqref{eq:mode_product_parafac} and \eqref{eq:parafac_rx_signal},
the matrices  $\gls{rxBeamMtx}^T$,  $\gls{txBeamMtx}^T$, and $\gls{pSymMtx}^T$
compress 1-mode, 2-mode, and 3-mode, respectively. Therefore, the received
tensor signal is the compressed version of the channel. Assuming that the tensor channel
$\gls{chTen}$ admits a sparse representation, the received signal can again be
rewritten as
\begin{equation}
  \label{eq:sparse_parafac_rx_signal}
    \gls{rxOutputTen}=   \gls{eyeTen} \times_1  \gls{rxBeamMtx}^T\gls{orTh}_1\gls{spMtx}_1 \times_2  \gls{txBeamMtx}^T\gls{orTh}_2\gls{spMtx}_2 \times_3 \gls{pSymMtx}^T\gls{orTh}_3\gls{spMtx}_3 + \gls{errorTen}.
\end{equation}
where $\gls{orTh}_1$ $\in$ $\mathbb{C}^{\gls{nAntRx} \times \gls{nAntRx} }$,
$\gls{orTh}_2$ $\in$ $\mathbb{C}^{\gls{nAntTx} \times \gls{nAntTx} }$, and $\gls{orTh}_3$ $\in$ $\mathbb{C}^{\gls{nTimeSamples} \times \gls{nTimeSamples} }$, are orthogonal
bases to the tensor modes, and $\gls{spMtx}_1$ $\in$
$\mathbb{C}^{\gls{nAntTx}\times \gls{nTaps}}$, $\gls{spMtx}_2$ $\in$
$\mathbb{C}^{\gls{nAntRx}\times \gls{nTaps}}$, and $\gls{spMtx}_3$ $\in$
$\mathbb{C}^{\gls{nTimeSamples}\times \gls{nTaps}}$ are sparse matrices
associated to each tensor mode. Given that $\gls{spMtx}_1$, $\gls{spMtx}_2$ and
$\gls{spMtx}_3$ are sparse, consider that $\gls{sparsity}_1$ $(\gls{sparsity}_2,\gls{sparsity}_3)$ is an
upper bound on the number of non-zero elements per column of $\gls{spMtx}_1$
(respectively $\gls{spMtx}_2,\gls{spMtx}_3$). 


To recover the \gls{csi}, both the channel and
received signal tensors must obey the uniqueness condition of the
\gls{PARAFAC} model. The \textit{Kruskal-rank} of $\gls{rxStrMtx}$, denoted as
$k_{\gls{rxStrMtx}}$, is the maximum $k$ such that any $k$ columns of
$\gls{rxStrMtx}$ are linearly independent $(k_{\gls{rxStrMtx}} <
r_{\gls{rxStrMtx}} \equiv \textrm{rank}(\gls{rxStrMtx}) ) $. Given the channel
tensor $\gls{chTen}$, if
$k_{\gls{rxStrMtx}}+k_{\gls{txStrMtx}}+k_{\gls{delayMtx}} \geq 2\gls{nTaps} +
2$, then $(\gls{rxStrMtx},\gls{txStrMtx},\gls{delayMtx})$ are unique up to a
common column permutation and scaling \cite{Sidiropoulos:2000}. The uniqueness
condition of the received tensor signal is given by \cite{Sidiropoulos:2012}
%$\gls{sparsity}_1,(\gls{sparsity}_2$ and $,\gls{sparsity}_3$, and is stated in \cite{Sidiropoulos:2012}
\begin{theorem}
  \label{th.:compressed_parafac}
    Considering the upper bounds $\gls{sparsity}_1,\gls{sparsity}_2,$ and
    $\gls{sparsity}_3$ on the number of nonzero elements per column of
    $\gls{spMtx}_1, \gls{spMtx}_2,$ and $\gls{spMtx}_3$, respectively, if
    \begin{equation}
      \label{eq.uniqueness_compress_parafac}
      \min (\gls{nRxBeam},k_{\gls{spMtx}_1}) +\min (\gls{nTxBeam},k_{\gls{spMtx}_2}) + \min (\gls{pLength},k_{\gls{spMtx}_3}) \geq 2\gls{nTaps} + 2,
    \end{equation}
    and $\gls{nRxBeam} \geq 2 \gls{sparsity}_1$, $\gls{nTxBeam} \geq 2
    \gls{sparsity}_2$, $\gls{pLength} \geq 2 \gls{sparsity}_3$, then the
    matrices $\gls{spMtx}_1, \gls{spMtx}_2,$ and $\gls{spMtx}_3$ are almost sure identifiable.
\end{theorem}

Exploiting the Theorem \ref{th.:compressed_parafac}, the system can properly
choose the number of receiver beams, transmit beams, pilot symbols that
guarantee uniqueness of the model. Assume that sparse matrices meet the condition $r_{\gls{spMtx}_1}=k_{\gls{spMtx}_1}$,
$r_{\gls{spMtx}_2}=k_{\gls{spMtx}_2}$, and
$r_{\gls{spMtx}_3}=k_{\gls{spMtx}_3}$, i.e. the factor matrices can not have a
column that is a scaled version of another one. This means that the two
distinct paths can not have the neither the
same spatial signal signature nor the same propagation delay.  Under such an
assumption we can state important corollaries.
\begin{enumerate}
\item If $\gls{nRxBeam}\geq\gls{nTaps}$ and   $\gls{nTxBeam}\geq 2\gls{nTaps}$, then
  $\gls{pLength} \geq 2\gls{sparsity}_3$ pilot symbols are per frame is enough to estimate
  \gls{nTaps} paths. Thus, the overhead per frame can be reduced at the minimum
  of $2\gls{sparsity}_3$.
\item If $\gls{nRxBeam} \geq \gls{nTaps}$ and   $\gls{pLength} \geq \gls{nTaps}$, then
  $\gls{nTxBeam} \geq 2\gls{sparsity}_2$ transmit beams are sufficient to estimate
  \gls{nTaps} paths. Because the  transmit beams is associated to the number of
  frames, the total number of training frames is reduced to $2\gls{sparsity}_2$.
\item If $\gls{nTxBeam} \geq \gls{nTaps}$ and   $\gls{pLength} \geq \gls{nTaps}$, then
  $\gls{nRxBeam} \geq 2\gls{sparsity}_1$ receive beams are sufficient to estimate
  \gls{nTaps} paths. This configuration can be useful for scenarios where the
  receiver has limited number of \gls{RF} chains, so this implies that the
  system must increase either the number of beams or the pilot sequences.
\end{enumerate}



Another implication of the Theorem \ref{th.:compressed_parafac} asserts that the matrices
$\gls{spMtx}_1, \gls{spMtx}_2,$ and $\gls{spMtx}_3$ are indentifiable from the
received signal $\gls{rxOutputTen}$ if $\gls{nRxBeam}>k_{\gls{spMtx}_1}$,
$\gls{nTxBeam}>k_{\gls{spMtx}_2}$, $\gls{pLength}>k_{\gls{spMtx}_3}$ as if the
receiver has available the channel $\gls{chTen}$. It is important to highlight
that if we decide to neglect the channel low-rank structure and attempt to
estimate the sparse vector formed by $\gls{nTaps} \gls{sparsity}_1
\gls{sparsity}_2 \gls{sparsity}_3$ non-zero elements, then
$\gls{nRxBeam}\gls{nTxBeam}\gls{pLength} \geq 2 \gls{nTaps}\gls{sparsity}_1\gls{sparsity}_2\gls{sparsity}_3$
must hold. Assuming
$\gls{sparsity}_1=\gls{sparsity}_2=\gls{sparsity}_3=\gls{sparsity}$, the vector
problem formulation needs $2\gls{nTaps}\gls{sparsity}^3$ measurements while the
problem exploiting the \gls{PARAFAC} framework needs $8\gls{sparsity}^3$.
Therefore, the number of measurements does not depend on the number of paths,
but only the sparsity on the factor matrices. In principle, if we know that
$\gls{orTh}_1$, $\gls{orTh}_2$, and $\gls{orTh}_3$ returns the sparsest
factor matrices, the receiver  measures the channel  $\gls{chTen}$ using the fewest
amount of samples, so the system overhead achieves the its lower-bound. Of
course, more accurate estimations are possible the more samples are collected as
we show in the results.






\subsection{Algorithm Description}

We exploit the principle of \gls{als} to fit the compressed \gls{PARAFAC} model
obtained from noisy observations. After this, we compute separately the minimum $l_1$-norm
solution for each factor matrix.

The idea behind the \gls{als} consist of updating a subset of \gls{PARAFAC} parameters
according. We define $\bfA =
\gls{rxBeamMtx}^T\gls{orTh}_1\gls{spMtx}_1$, $\bfB =
\gls{txBeamMtx}^T\gls{orTh}_2\gls{spMtx}_2$, and $\bfC =
\gls{pSymMtx}^T\gls{orTh}_3\gls{spMtx}_3$   as the factor matrices of
$\gls{rxOutputTen}$. We obtain them using \gls{ls} criterion conditioned on estimation of the remaining
parameters. More specifically, we exploit the unfolding representations
\begin{align}
 \gls{rxOutputMtx}_1 = (\bfB \odot \bfC)\bfA^T \\
 \gls{rxOutputMtx}_2 = (\bfC \odot \bfA)\bfB^T \\
 \gls{rxOutputMtx}_3 = (\bfA \odot \bfB)\bfC^T
\end{align}
and recover $\bfA$, $\bfB$, and $\bfC$ by calculating the pseudoinverse of the
matrix resulting from the Katri-rao product. For instance, the factor matrix of
1-mode is $\hat{\bfA}^T = (\bfB \odot \bfC)^{\dagger}\gls{rxOutputMtx}_1 $;
similarly, $\hat{\bfB}$ and $\hat{\bfC}$ are calculated. Repeat this procedure
until the error $e = \|\hat{\gls{rxOutputMtx}}_1 - \gls{rxOutputMtx}_1 \|^2_F/
\|\gls{rxOutputMtx}_1\|_F^2 < \sigma ^2$; this criterion asserts the algorithm convergence. We summarize the steps of \gls{als} in the Table~\ref{alg.:als}. 

Fitting the \gls{PARAFAC} model to the compressed tensor $\gls{rxOutputTen}$,
the next step consist of solving three compressive sensing problems to estimate
$\gls{spMtx}_1$, $\gls{spMtx}_2$, and $\gls{spMtx}_3$. The mathematical
formulation for the 1-mode is
\begin{equation}
  \label{eq:l1_norm_modeOne}
  \min_{\gls{spVec}_1} \|\hat{\bfa} - \left( \gls{eye} \otimes \gls{rxBeamMtx}^T\gls{orTh}_1\right) \gls{spVec}_1\|_2 + \beta \|\gls{spVec}_1\|_1, 
\end{equation}
where $\hat{\bfa} \equiv \textrm{vec}\{\hat{\bfA}\}$ and  $\gls{spVec}_1 \equiv
\textrm{vec}\{\gls{spMtx}_1\}$. The problem in \eqref{eq:l1_norm_modeOne} is a
\gls{lasso} problem and can be solved using convex optimization solvers
\cite{Boyd:2004}. The 2-mode and 3-mode can be formulated similarly as in
\eqref{eq:l1_norm_modeOne}. The outcome of the three problems gives a sparse \gls{PARAFAC} model with
the factor matrices $\gls{spMtx}_1$, $\gls{spMtx}_2$, and $\gls{spMtx}_3$ that
can be mapped to the tensor $\gls{chTen}$ by using the mode product with
$\gls{orTh}_1$,  $\gls{orTh}_2$, and $\gls{orTh}_3$, i.e.
\begin{equation}
  \label{eq:sparse_mapping}
 \hat{\gls{chTen}}  =   \gls{eyeTen} \times_1  \gls{orTh}_1\gls{spMtx}_1 \times_2  \gls{orTh}_2\gls{spMtx}_2 \times_3 \gls{orTh}_3\gls{spMtx}_3.
\end{equation}

The matrices \gls{rxBeamMtx},
\gls{txBeamMtx}, and \gls{pSymMtx} are the measurement matrices, i.e. each one
performs measurements of the channel \gls{chTen} associated to their own modes.
The optimum design is desired so the maximum channel compression is achieved,
however, such a problem  is not investigated in this paper. For the ease of
explanation, the receiver uses $\gls{rxBeamMtx} =
\gls{rxBeamMtx}_{\gls{RF}}$,  and the transmitter employs $\gls{txBeamMtx} =
\gls{txBeamMtx}_{\gls{RF}}$. They are obtained from a Bernoulli distribution which meets the constant
modulus restriction of the analog beamforming. Nevertheless such a distribution
is convenient, it is known from the
literature that the Gaussian complex distribution provides the best
performance in sparse problem frameworks, as discussed in  \cite{Donoho:2006}.
Although the use of such a distribution does not lead to a typical analog beamforming
matrix, it is possible to use this set of matrices if the analog
and digital beamformers are designed such that the resulting matrices
\gls{rxBeamMtx} and \gls{txBeamMtx} have entries that follow 
Gaussian complex distribution. 


\label{sec:algorithm}
\begin{algorithm}   
    \caption{\gls{als} description } \label{alg.:als}
    \begin{algorithmic}
      \STATE Initialize factor matrices $\bfA$, $\bfB$, and $\bfC$.
%      \STATE $\gls{rxOutputMtx}_1 \gets (\bfB \odot \bfC)\bfA^T$
%      \STATE $\gls{rxOutputMtx}_2 \gets (\bfC \odot \bfA)\bfB^T$
%      \STATE $\gls{rxOutputMtx}_3 \gets (\bfA \odot \bfB)\bfC^T$
      \WHILE{ $ e > \sigma ^2$}
      \STATE $\hat{\bfA}^T \gets (\bfB \odot \bfC)^{\dagger}\gls{rxOutputMtx}_1 $
      \STATE $\hat{\bfB}^T \gets (\bfC \odot \hat{\bfA})^{\dagger}\gls{rxOutputMtx}_2 $
      \STATE $\hat{\bfC}^T \gets ({\bfA} \odot \hat{\bfB})^{\dagger}\gls{rxOutputMtx}_3 $
      \STATE $\hat{\gls{rxOutputMtx}}_1 \gets (\hat{\bfB} \odot \hat{\bfC})\hat{\bfA}^T$
      \STATE $ e \gets \|\hat{\gls{rxOutputMtx}}_1 - \gls{rxOutputMtx}_1 \|^2_F/ \|\gls{rxOutputMtx}_1\|_F^2$
      \ENDWHILE

      
    \end{algorithmic}
\end{algorithm}

\section{Results}

In this section, the performance of the proposed method is
evaluated in terms of the \gls{NMSE} which is defined as 
\begin{equation}
  \label{eq:nmse}
  \textrm{NMSE} = \sum^{V}_{v=1} \frac{\|\hat{\gls{chTen}}_v - \gls{chTen} \|^{2}_F}{\|\gls{chTen} \|^{2}_F},
\end{equation}
where $v$ are the montecarlo simulations.
First, we apply \gls{als}, described in
\ref{alg.:als}, to obtain \gls{PARAFAC} decomposition of the compressed tensor \gls{rxOutputTen}.
Second, we apply matching pursuit algorithm (e.g. \cite{Tropp:2008}) to solve for the sparse recovery of each factor matrix, from each the channel parameters can be extracted.
% to obtain the sparse representation
% of the factor matrices .

We consider a scenario with  $\gls{nAntTx}=64$ transmitter antennas and
$\gls{nAntRx}=16$ receiver antennas. Both arrays are linear with half length
separation. The frame length is $\gls{nTime} = 20$ and the delay tap length is
assumed to be $\gls{nTaps}=3$. 

Fig. \ref{fig:tx_beams}  shows the estimation performance for  $\gls{nTxBeam} =
\{2,6,20,32\}$ number of beams. The algorithms fails in estimating the channel
for $\gls{nTxBeam}=2$, for the corollary 2 is not satisfied. The number of taps
$\gls{nTaps}=3$ requires that the number of transmit beams $\gls{nTxBeam} \geq 6
$, otherwise the uniqueness of the model is not guaranteed. Assuming such
condition is achieved, the estimation improves the more transmit beams are
used which leads to use of more training frames. Thus, the performance
improvement comes at the cost of more overhead as expected.


Fig \ref{fig:rx_beams} shows another approach to improve the channel estimation. Instead
of increasing the number of transmit beams, it is possible to use more receive
receive beams \gls{nRxBeam} that measures that channel within the frame period. This will require more \gls{RF} chains to be used at the same time, so there
is a trade-off among hardware complexity, system overhead, and accuracy so that
system can offer good spectral efficiency (reduced overhead) but using
transceivers with reduced number of combiners. Nevertheless the increasing of
the number of transmit beams can afford to reduce the pilot sequence length, it cannot be $\gls{pLength}<6$ as it violates the
first corollary; therefore, the uniqueness of the \gls{PARAFAC} model does not hold. 


\begin{figure}[!t]
  \centering
  \includegraphics[width=0.48\textwidth]{fig/snr_nmse}
  \caption{The plots show the tensor-based algorithm performance when we vary the
    number of transmit beams. }
  \label{fig:tx_beams}
\end{figure}

% \begin{figure}[!t]
%   \centering
%   \includegraphics[width=0.48\textwidth]{fig/snr_nmse_rx}
%   \caption{The plots show the tensor-based algorithm performance when we vary the
%     number of receive beams.  }
%   \label{fig:rx_beams}
% \end{figure}

\begin{figure}[!t]
  \centering
  \includegraphics[width=0.48\textwidth]{fig/snr_angleTx_error}
  \caption{The plots show the estimation error of the \gls{AoD}}
  \label{fig:rx_beams}
\end{figure}


\section{Conclusion}
In this paper, we investigated the problem of estimating frequency selective
channels under the assumption that transmitter and receiver have a hybrid
architecture. The proposed solution exploits jointly the intrinsic sparsity of a
three dimensional channel. Using the sparse \gls{PARAFAC} model, we provides
useful bounds on the minimum
number of transmit beams,  receive beams, and length of the pilot sequence that
guarantee the uniqueness of the model. This offers  flexibility to the system
as it can conveniently control the system overhead according to the number of \gls{RF} chains and spectral efficiency by choosing the number of beams and pilot
sequence length. In future works, we intend to extend the proposed tensor-based
compressive channel estimator to time varying channels whose time response changes from frame-to-frame.

%\section*{Acknowledgment}
\newpage
\bibliographystyle{IEEEtran}
\bibliography{latex-aux/reference}

\end{document}



%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
