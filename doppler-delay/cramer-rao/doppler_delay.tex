\documentclass[12pt,a4paper,twoside,english]{article}


\input{packages}
\input{mymath}

\begin{document}
	
\section{Cramer-Rao bound}	
	Let us consider a single antenna transmitter and receiver that communicates through a channel that is composed by a single tap. The transmitted signal is defined as $s(t)$ and the received signal is $r(t)$. Assuming the receiver samples the received signal $r(t)$, the system model is written as
	\begin{equation}
		r(nT) = \underbrace{\beta s(nT - \tau)\textrm{e}^{-2\pi \jmath f_DT n}}_{\mu (f_D,\tau,n)} + z(nT),
	\end{equation}
where $\beta$ is the propagation loss, $f_D$ is the doppler deviation, $\tau$ is the delay, and $T$ is the sampling period. The pdf of the received signal is give by

\begin{equation}
  g(f_D,\tau) = \frac{1}{\sqrt{2\pi \sigma ^2}}\textrm{e}^{\frac{| \bfr - \bm{\mu} (f_D,\tau)|^2}{2\sigma^2}}
\end{equation}

Calculate the first derivative with respect the doppler.
\begin{align}\label{eq.: doppler_first}
  \frac{\partial \bm{\mu} (f_D,\tau)}{\partial f_D} & = -2\pi \jmath T \bfs (\tau) \odot \bfe
\end{align}

\begin{align}\label{eq.: doppler_first_conj}
  \frac{\partial \bm{\mu}^H(f_D,\tau)}{\partial f_D} & = 2\pi \jmath T \bfs^{H} (\tau)\odot \bfe^{*}
\end{align}

\begin{align}\label{eq.: tau_first}
  \frac{\partial \bm{\mu} (f_D,\tau)}{\partial \tau} & = -\bfs^{\prime} (\tau)\odot \tilde{\bfe}
\end{align}


\begin{align}\label{eq.: tau_first_conj}
  \frac{\partial \bm{\mu}^{H} (f_D,\tau)}{\partial \tau} & = -\left(\bfs^{\prime}(\tau) \odot  \tilde{\bfe} \right)^{H} 
\end{align}
where $\bfe[n] = n\textrm{e}^{-2\pi \jmath f_DT n}$ and $\tilde{\bfe}[n] = \textrm{e}^{-2\pi \jmath f_DT n}$

\[  \bfI(f_D,\tau) = 
  \begin{bmatrix}
   2\textrm{Re}\{ \frac{\partial \bm{\mu}^H(f_D,\tau)}{\partial
      f_D} \frac{\partial \bm{\mu} (f_D,\tau)}{\partial f_D} \} & 2\textrm{Re}\{\frac{\partial
      \bm{\mu}^H(f_D,\tau)}{\partial f_D}\frac{\partial \bm{\mu}
      (f_D,\tau)}{\partial \tau}  \} \\
     2\textrm{Re}\{ \frac{\partial \bm{\mu}^H(f_D,\tau)}{\partial
      \tau} \frac{\partial \bm{\mu} (f_D,\tau)}{\partial f_D} \} & 2\textrm{Re}\{\frac{\partial
      \bm{\mu}^H(f_D,\tau)}{\partial \tau}\frac{\partial \bm{\mu}
      (f_D,\tau)}{\partial \tau}  \} \\
  \end{bmatrix}
\]



\[  \bfI(f_D,\tau) = 
  \begin{bmatrix}
   2\textrm{Re}\{ 4 \pi^2 T^2|\beta|^2 \sum^{N-1}_{n=0}n^2|\bfs_n (\tau)|^2  \} &
   2\textrm{Re}\{ 2\pi \jmath T   \sum^{N-1}_{n=0} n\bfs_n^{*} (\tau)\bfs_n^{\prime} (\tau) \} \\
     2\textrm{Re}\{ 2\pi \jmath T   \sum^{N-1}_{n=0} n\bfs_n(\tau)\left(\bfs_n^{\prime} (\tau)\right)^{*} \} & 2\textrm{Re}\{  4 \pi^2 T^2 |\beta|^2 \sum^{N-1}_{n=0}|\bfs^{\prime}_n (\tau)|^2 \} \\
  \end{bmatrix}
\]

The inverse of Fisher matrix is
\[  \bfI(f_D,\tau) = \frac{1}{\textrm{det}(\bfI(f_D,\tau))}
\begin{bmatrix}
  2\textrm{Re}\{  4 \pi^2 T^2 |\beta|^2 \sum^{N-1}_{n=0}|\bfs^{\prime}_n
  (\tau)|^2 \}  &
   - 2\textrm{Re}\{ 2\pi \jmath T   \sum^{N-1}_{n=0} n\bfs_n^{*} (\tau)\bfs_n^{\prime} (\tau) \} \\
     - 2\textrm{Re}\{ 2\pi \jmath T   \sum^{N-1}_{n=0}
     n\bfs_n(\tau)\left(\bfs_n^{\prime} (\tau)\right)^{*} \} & 2\textrm{Re}\{ 4
     \pi^2 T^2|\beta|^2 \sum^{N-1}_{n=0}n^2|\bfs_n (\tau)|^2  \}  \\
\end{bmatrix}
\]
where

\begin{align}
  \textrm{det}(\bfI(f_D,\tau)) & =  64 \pi^4 T^4 |\beta|^4 \sum^{N-1}_{n=0}\sum^{N-1}_{m=0}n^2|\bfs^{\prime}_n
                                 (\tau)|^2|\bfs_m (\tau)|^2 - \ldots \nonumber \\
                                 & = 4\textrm{Re}\{ 2\pi \jmath T   \sum^{N-1}_{n=0} n\bfs_n^{*} (\tau)\bfs_n^{\prime} (\tau) \}\textrm{Re}\{ 2\pi \jmath T   \sum^{N-1}_{n=0}
     n\bfs_n(\tau)\left(\bfs_n^{\prime} (\tau)\right)^{*} \}
\end{align}


\end{document}